
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1. Estimation Theory &#8212; Math and Stats</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Cases and Conditions" href="08_Confidence_Intervals.html" />
    <link rel="prev" title="1. Probability Distribution Functions" href="06_Probability_Distribution_Functions.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Math and Stats</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Content/Intro.html">
   Preface
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Python
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01_Introduction_to_Python.html">
   1. Introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_Matplotlib.html">
   2. Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_Graphs_with_Pandas.html">
   3. Graphics with Pandas
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  EDA
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Central_Tendency.html">
   1. Central Tendency Measures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_Descriptive_Stats_with_Pandas.html">
   2. Descriptive Statistics with Pandas
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Probability Theory
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="06_Probability_Distribution_Functions.html">
   1. Probability Distribution Functions
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Inference Theory
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. Estimation Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08_Confidence_Intervals.html">
   2.
   <font color="Red">
    Cases and Conditions
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08_Confidence_Intervals.html#font-color-red-application-font">
   3.
   <font color="Red">
    Application
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_Hypothesis_Testing.html">
   4. Hypothesis Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_Hypothesis_Testing.html#font-color-red-types-of-tests-font">
   5.
   <font color="Red">
    Types of Tests
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_Hypothesis_Testing.html#font-color-red-performing-a-test-font">
   6.
   <font color="Red">
    Performing a Test
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_Hypothesis_Testing.html#font-color-red-python-tests-font">
   7.
   <font color="Red">
    Python Tests
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_Power_of_the_test.html">
   8. Power of the Test
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Statistical Learning
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="Statistical_Models.html">
   1. Statistical Models
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="11_Linear_Model.html">
     1.5.1. Linear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="12_ANOVA.html">
     1.5.2. ANOVA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="13_Time_Series.html">
     1.5.3. Time Series
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_Association_Rules.html">
   2.
   <font color="0061c7">
    Association Rules
   </font>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="061_Naive_Bayes.html">
   3.
   <font color="0061c7">
    Naïve Bayes
   </font>
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/07_Estimation_Theory.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/07_Estimation_Theory.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://jjmanjarin.github.io/MathNStats"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://jjmanjarin.github.io/MathNStats/issues/new?title=Issue%20on%20page%20%2F07_Estimation_Theory.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prof-dr-juanjo-manjarin">
   1.1. Prof. Dr.Juanjo Manjarín
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-central-limit-theorem">
   1.2. The Central Limit Theorem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sampling-distribution-of-sampling-statistics">
   1.3. Sampling Distribution of Sampling Statistics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling-distribution-of-sampling-means">
     1.3.1. Sampling Distribution of Sampling Means
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling-distribution-of-sampling-variances">
     1.3.2. Sampling Distribution of Sampling Variances
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-chi-2-distribution">
       1.3.2.1. The
       <span class="math notranslate nohighlight">
        \(\chi^2\)
       </span>
       distribution
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling-distribution-of-sampling-proportions">
     1.3.3. Sampling Distribution of Sampling Proportions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confidence-intervals">
   1.4. Confidence Intervals
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#confidence-interval-of-the-mean-of-a-population-with-known-variance">
     1.4.1. Confidence Interval of the Mean of a Population with Known Variance
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#confidence-intervals-in-python">
       1.4.1.1. Confidence Intervals in Python
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#changing-parameters">
       1.4.1.2. Changing Parameters
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpretation-of-a-c-i">
     1.4.2. Interpretation of a C.I.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#confidence-interval-for-the-population-mean-of-a-population-with-unkown-variance">
     1.4.3. Confidence Interval for the Population Mean of a Population with Unkown Variance
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-t-student-distribution">
       1.4.3.1. The t-Student distribution
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#confidence-interval-in-python">
       1.4.3.2. Confidence Interval in Python
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#confidence-interval-for-a-population-proportion">
     1.4.4. Confidence Interval for a Population Proportion
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       1.4.4.1. Confidence Interval in Python
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="estimation-theory">
<h1><span class="section-number">1. </span>Estimation Theory<a class="headerlink" href="#estimation-theory" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prof-dr-juanjo-manjarin">
<h2><span class="section-number">1.1. </span>Prof. Dr.Juanjo Manjarín<a class="headerlink" href="#prof-dr-juanjo-manjarin" title="Permalink to this headline">¶</a></h2>
<p><strong>Statistics &amp; Data Analysis</strong></p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">ss</span>
<span class="kn">import</span> <span class="nn">statsmodels.stats.weightstats</span> <span class="k">as</span> <span class="nn">smw</span>
<span class="kn">import</span> <span class="nn">statsmodels.stats.proportion</span> <span class="k">as</span> <span class="nn">smp</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-central-limit-theorem">
<h2><span class="section-number">1.2. </span>The Central Limit Theorem<a class="headerlink" href="#the-central-limit-theorem" title="Permalink to this headline">¶</a></h2>
<p>This is a main result in statistics and states that</p>
<br>
<p><em>“For a set of <span class="math notranslate nohighlight">\(n\)</span> independent random variables with arbitrary probability distribution with mean <span class="math notranslate nohighlight">\(E[X]\)</span> and standard deviation <span class="math notranslate nohighlight">\(SD[X]\)</span>, their sum</em></p>
<div class="amsmath math notranslate nohighlight" id="equation-32138d81-a4ec-487b-91a1-4507baf7b9cd">
<span class="eqno">(1.71)<a class="headerlink" href="#equation-32138d81-a4ec-487b-91a1-4507baf7b9cd" title="Permalink to this equation">¶</a></span>\[\begin{equation}
X = \sum_i^n \xi_i
\end{equation}\]</div>
<p><em>has, in the limit <span class="math notranslate nohighlight">\(n\to\infty\)</span>, a cumulative distribution from</em></p>
<div class="amsmath math notranslate nohighlight" id="equation-30880d20-be87-4ad0-b02e-d70460d406c5">
<span class="eqno">(1.72)<a class="headerlink" href="#equation-30880d20-be87-4ad0-b02e-d70460d406c5" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{X-E[X]}{SD[X]}
\end{equation}\]</div>
<p><em>which approaches the standard normal distribution.”</em></p>
<br>
<p>Let’s define the following function to illustrate this main result in Python</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clt</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  This function uses the Exponential Distribution with scale = 1/lambda to ilustrate </span>
<span class="sd">  the Central Limit Theorem. This can be changed at your own will, but then be careful</span>
<span class="sd">  with the arguments of the function. The function computes the distribution of means or </span>
<span class="sd">  of variances of a set of 500 random samples</span>

<span class="sd">  Inputs:</span>
<span class="sd">  m: loc of the exponential</span>
<span class="sd">  scale: scale of the exponential</span>
<span class="sd">  n: number of observations for the random generator</span>
<span class="sd">  x: measure to be used, can be &#39;mean&#39; or &#39;var&#39;</span>

<span class="sd">  Output:</span>
<span class="sd">  np.array with 500 values of the measure used in each sample </span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="n">dist</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">expon</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">({</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span>
                   <span class="s1">&#39;var&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
                   <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;Measures must be: &quot;mean&quot; or &quot;var&quot;&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s use it to see the evolution of a distribution of means with icreasing values of <span class="math notranslate nohighlight">\(n\)</span>. In particular let’s take values from <span class="math notranslate nohighlight">\(2\)</span> to <span class="math notranslate nohighlight">\(1000\)</span> (change these values at your own will to see other possibilities).</p>
<p>Since the mean is precisely a sum of <span class="math notranslate nohighlight">\(n\)</span> random variables, this theorem should apply (the same is true for any other moment: variance, skewness and so on), then again, change this measure to see how other options behave</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nSet</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="p">,</span><span class="mi">20</span> <span class="p">,</span><span class="mi">45</span> <span class="p">,</span><span class="mi">150</span> <span class="p">,</span><span class="mi">400</span> <span class="p">,</span><span class="mi">1000</span><span class="p">]</span>
<span class="n">coords</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nSet</span><span class="p">,</span> <span class="n">coords</span><span class="p">):</span>
  <span class="n">mean</span> <span class="o">=</span> <span class="n">clt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
  <span class="n">sd</span> <span class="o">=</span> <span class="n">clt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mean</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">sd</span><span class="p">,</span> <span class="n">mean</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sd</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Central Limit Theorem&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">clt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;darkgreen&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;limegreen&quot;</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> 
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;n = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, E[x] = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;, SD[x] = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density&quot;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sd</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07_Estimation_Theory_5_0.png" src="_images/07_Estimation_Theory_5_0.png" />
</div>
</div>
<p>Now, if you see there is a <strong>main assumption</strong> in this theorem:the random variables must have a <strong>mean</strong> and a <strong>variance</strong> (standard deviation). This seems to be the case in many situations, but there are some real life cases in which this assumption does not hold, for example, in <strong>finance</strong>, the distribution of differences in the closing prices of stocks usually have to be described by <strong>Cauchy-Lorentz</strong> distributions. The main problem in this case is that there are too many outliers and their contribution can be too much to let the integral of the mean converge to a finite value (this is true also for the variance and any other higher moment).</p>
<p>If there is no mean and no standard deviation, the central limit simply does not hold. Let’s see it using the Cauchy distribution</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clt_cauchy</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
  <span class="n">dist</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">cauchy</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">({</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span>
                   <span class="s1">&#39;var&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
                   <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;Measures must be: &quot;mean&quot; or &quot;var&quot;&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>then using a set of larger values for <span class="math notranslate nohighlight">\(n\)</span> than the previous ones</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nSet</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="p">,</span><span class="mi">50</span> <span class="p">,</span><span class="mi">250</span> <span class="p">,</span><span class="mi">500</span> <span class="p">,</span><span class="mi">1000</span> <span class="p">,</span><span class="mi">5000</span><span class="p">]</span>
<span class="n">coords</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nSet</span><span class="p">,</span> <span class="n">coords</span><span class="p">):</span>
  <span class="n">mean</span> <span class="o">=</span> <span class="n">clt_cauchy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
  <span class="n">sd</span> <span class="o">=</span> <span class="n">clt_cauchy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mean</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">sd</span><span class="p">,</span> <span class="n">mean</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sd</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Central Limit Theorem&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">clt_cauchy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">ec</span> <span class="o">=</span> <span class="s2">&quot;darkgreen&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;limegreen&quot;</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> 
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;n = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, E[x] = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;, SD[x] = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density&quot;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sd</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07_Estimation_Theory_9_0.png" src="_images/07_Estimation_Theory_9_0.png" />
</div>
</div>
<p>see that it does not really matter how big we choose the value of <span class="math notranslate nohighlight">\(n\)</span>: the distribution of means does not converge into the normal distribution.</p>
<p>In this course we will restrict ourselves to those cases in which the central limit theorem holds and then we can use the results in the next sections for inference.</p>
</div>
<div class="section" id="sampling-distribution-of-sampling-statistics">
<h2><span class="section-number">1.3. </span>Sampling Distribution of Sampling Statistics<a class="headerlink" href="#sampling-distribution-of-sampling-statistics" title="Permalink to this headline">¶</a></h2>
<p>A sampling distribution of sampling statistics is the probability distribution that results from finding the given statistic in all the possible samples of fixed size from a population.</p>
<p>In particular we are going to see:</p>
<ul class="simple">
<li><p>The <strong>sampling distribution of sampling means</strong> where the statistic computed is the mean</p></li>
<li><p>The <strong>sampling distribution of sampling variances</strong> where the statistic computed is the variance</p></li>
<li><p>The <strong>sampling distribution of sampling proportions</strong> where the statistic computed is the proportion</p></li>
</ul>
<div class="section" id="sampling-distribution-of-sampling-means">
<h3><span class="section-number">1.3.1. </span>Sampling Distribution of Sampling Means<a class="headerlink" href="#sampling-distribution-of-sampling-means" title="Permalink to this headline">¶</a></h3>
<p>As said before, we take all the possible samples of fixed size from a population and find all their means, then the expected values and variance of this distribution of means must exist if we want to use the central limit theorem.</p>
<p>Now, in estimation we <em>define</em> he estimator as rule where:</p>
<ul class="simple">
<li><p>We <strong>assign</strong> the value of the statistic we compute to the value of the population</p></li>
<li><p>This assignment is completely independent of the population size (so this is true even for size <span class="math notranslate nohighlight">\(n=1\)</span>), i.e.</p></li>
</ul>
<div class="amsmath math notranslate nohighlight" id="equation-4444e3f4-5c65-4db4-8fc0-d2dea68342b5">
<span class="eqno">(1.73)<a class="headerlink" href="#equation-4444e3f4-5c65-4db4-8fc0-d2dea68342b5" title="Permalink to this equation">¶</a></span>\[\begin{equation}
 E[x]=\mu
 \end{equation}\]</div>
<p>for any observation <span class="math notranslate nohighlight">\(x\)</span></p>
<p>Remember that we know that this is not necessarily <em>true</em> and we will have to deal with the associated problems through the estimation of the <strong>standard error</strong>, i.e. the standard deviation of the estimator.</p>
<p>Then for samples of arbitrary size <span class="math notranslate nohighlight">\(n\)</span> we can find the distribution of all the possible means and now find the expected value of this distribution</p>
<div class="amsmath math notranslate nohighlight" id="equation-5fddca4b-9340-41fd-92c4-b687e1aa9a30">
<span class="eqno">(1.74)<a class="headerlink" href="#equation-5fddca4b-9340-41fd-92c4-b687e1aa9a30" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\begin{array}{rcl}
E[\bar x] &amp; = &amp; \displaystyle E\left[\frac{1}{n}\sum_i^n x_i\right]\\[2ex]
&amp; = &amp; \displaystyle\frac{1}{n}E\left[\sum_i^n x_i\right] \\[2ex]
&amp; = &amp; \displaystyle\frac{1}{n}\sum_i^n E[x_i]\\[2ex]
&amp; = &amp; \displaystyle\frac{n\mu}{n}\\[2ex]
&amp; = &amp; \mu
\end{array}
\end{equation}\]</div>
<p>therefore the <strong>expected value</strong> of the <strong>sampling distribution of sampling means</strong> exists and is equal to the <strong>population mean</strong>.</p>
<p>This property is what allow us to declare the sample mean as the <strong>point estimator</strong> of the population mean.</p>
<p>This computation can be repeated for the variance in order to find</p>
<div class="amsmath math notranslate nohighlight" id="equation-d9846f10-48a0-44ea-a853-7ea726158559">
<span class="eqno">(1.75)<a class="headerlink" href="#equation-d9846f10-48a0-44ea-a853-7ea726158559" title="Permalink to this equation">¶</a></span>\[\begin{equation}
V[\bar x] = \frac{\sigma^2}{n}
\end{equation}\]</div>
<p>from where we can find that the <strong>standard error</strong> is</p>
<div class="amsmath math notranslate nohighlight" id="equation-ccc1538c-7ae0-4c9b-b92a-66deff2174a1">
<span class="eqno">(1.76)<a class="headerlink" href="#equation-ccc1538c-7ae0-4c9b-b92a-66deff2174a1" title="Permalink to this equation">¶</a></span>\[\begin{equation}
SD[\bar x]=\frac{\sigma}{\sqrt{n}}
\end{equation}\]</div>
<p>we see that the dependence of the standard error with <span class="math notranslate nohighlight">\(n\)</span> is such that in the limit <span class="math notranslate nohighlight">\(n\to\infty\)</span>, it goes to 0, i.e. it is a consistent estimator and less efficient at smaller sample sizes that at higher ones. In fact, the sample mean is the more efficient unbiased estimator we can find for the population mean</p>
</div>
<div class="section" id="sampling-distribution-of-sampling-variances">
<h3><span class="section-number">1.3.2. </span>Sampling Distribution of Sampling Variances<a class="headerlink" href="#sampling-distribution-of-sampling-variances" title="Permalink to this headline">¶</a></h3>
<p>We mmay repeat the procedures before but using the variance as the estimator. However, if we use the common definition of variance</p>
<div class="amsmath math notranslate nohighlight" id="equation-3d67a8ee-293d-4fcc-b627-3d41039d2434">
<span class="eqno">(1.77)<a class="headerlink" href="#equation-3d67a8ee-293d-4fcc-b627-3d41039d2434" title="Permalink to this equation">¶</a></span>\[\begin{equation}
s_x^2=\frac{1}{n}\sum_i^n (x_i-\bar x)^2
\end{equation}\]</div>
<p>we find that it is a biased estimator, since its expected value is not equal to the population variance but</p>
<div class="amsmath math notranslate nohighlight" id="equation-9fd1e0b5-c276-40c6-8352-1950db8de688">
<span class="eqno">(1.78)<a class="headerlink" href="#equation-9fd1e0b5-c276-40c6-8352-1950db8de688" title="Permalink to this equation">¶</a></span>\[\begin{equation}
E[s_x^2] = \frac{n-1}{n}\sigma^2
\end{equation}\]</div>
<p>The conclusion is that we need to use another estimator for the population variance: the <strong>quasi-variance</strong></p>
<div class="amsmath math notranslate nohighlight" id="equation-b332eba2-dd00-44bb-aeb8-16f7a5724fee">
<span class="eqno">(1.79)<a class="headerlink" href="#equation-b332eba2-dd00-44bb-aeb8-16f7a5724fee" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\tilde s_x^2 = \frac{1}{n-1}\sum_i^n (x_i-\bar x)^2 = \frac{n}{n-1}s_x^2
\end{equation}\]</div>
<p>with this small change we obtain that</p>
<div class="amsmath math notranslate nohighlight" id="equation-44b7eac1-e062-42f9-a45a-d018164d9fa1">
<span class="eqno">(1.80)<a class="headerlink" href="#equation-44b7eac1-e062-42f9-a45a-d018164d9fa1" title="Permalink to this equation">¶</a></span>\[\begin{equation}
E[\tilde s_x^2] = \sigma^2
\end{equation}\]</div>
<p>note that from now on we will drop the tilde on top of the quasi-variance (as well as the <em>quasi</em>) and it should always be understood that the sample variance is always the quasi-variance.</p>
<p>From this definition we can also find that</p>
<div class="amsmath math notranslate nohighlight" id="equation-ec2eae4a-0ca7-4531-bb96-eb90f255cf95">
<span class="eqno">(1.81)<a class="headerlink" href="#equation-ec2eae4a-0ca7-4531-bb96-eb90f255cf95" title="Permalink to this equation">¶</a></span>\[\begin{equation}
V[\tilde s_x^2]=\frac{1}{n-1}\sigma^4
\end{equation}\]</div>
<p>although we will not use this standard error in our computations. Instead we typically use the <span class="math notranslate nohighlight">\(\chi^2\)</span>-distribution</p>
<div class="section" id="the-chi-2-distribution">
<h4><span class="section-number">1.3.2.1. </span>The <span class="math notranslate nohighlight">\(\chi^2\)</span> distribution<a class="headerlink" href="#the-chi-2-distribution" title="Permalink to this headline">¶</a></h4>
<p>we define the distribution as the sum of squares of standard normal distributions. Then using the proper definitions we can easily find that</p>
<div class="amsmath math notranslate nohighlight" id="equation-d3eab747-fd53-47da-b6a4-1654fda78684">
<span class="eqno">(1.82)<a class="headerlink" href="#equation-d3eab747-fd53-47da-b6a4-1654fda78684" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\begin{array}{rcl}
\chi^2_{n-1} &amp; = &amp; \displaystyle\sum_iZ_i^2\\[2ex]
&amp; = &amp; \displaystyle (n-1)\frac{s_x^2}{\sigma^2}
\end{array}
\end{equation}\]</div>
<p>therefore we can use this distribution to establish a relation between the population variance and the sample variance. We use the subindex <span class="math notranslate nohighlight">\(n-1\)</span> as a reference to the <strong>degrees of freedom</strong> of the distribution</p>
<p>Let’s see how this distribution changes with respect to these degrees</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>
</pre></div>
</div>
</div>
</div>
<p>then, let’s generate a set of distributions differing only in the sample size <span class="math notranslate nohighlight">\(n\)</span>, i.e. we take the standarized form and modify only the degrees of freedom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">nSet</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Chi-squared Distribution&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nSet</span><span class="p">:</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;DoF: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07_Estimation_Theory_17_0.png" src="_images/07_Estimation_Theory_17_0.png" />
</div>
</div>
<p>maybe the most important property of this distribution is that it is not symmetric and then we have to be careful once we compute the percentiles and the cumulative probabilities</p>
</div>
</div>
<div class="section" id="sampling-distribution-of-sampling-proportions">
<h3><span class="section-number">1.3.3. </span>Sampling Distribution of Sampling Proportions<a class="headerlink" href="#sampling-distribution-of-sampling-proportions" title="Permalink to this headline">¶</a></h3>
<p>The last case we are going to see is when we have a categorical variable (can be numerical but is less common) and we study the proportions. We take the sample proportion as</p>
<div class="amsmath math notranslate nohighlight" id="equation-51d4a2d3-449d-4495-86fd-2abb630cce23">
<span class="eqno">(1.83)<a class="headerlink" href="#equation-51d4a2d3-449d-4495-86fd-2abb630cce23" title="Permalink to this equation">¶</a></span>\[\begin{equation}
p_i = \frac{n_i}{n}
\end{equation}\]</div>
<p>then we want to find the expected value of a distribution of these proportions. We can write this as</p>
<div class="amsmath math notranslate nohighlight" id="equation-9d08688f-ced6-4d74-90ea-b05bf6fa5f9f">
<span class="eqno">(1.84)<a class="headerlink" href="#equation-9d08688f-ced6-4d74-90ea-b05bf6fa5f9f" title="Permalink to this equation">¶</a></span>\[\begin{equation}
P = \frac{X}{n}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(X\)</span> is a binomial random variable. Then, if we can use the normal approximation we can write</p>
<div class="amsmath math notranslate nohighlight" id="equation-b8d4a395-1cd9-4b05-ae95-6dd5c18695c0">
<span class="eqno">(1.85)<a class="headerlink" href="#equation-b8d4a395-1cd9-4b05-ae95-6dd5c18695c0" title="Permalink to this equation">¶</a></span>\[\begin{equation}
E[p] = P,\quad V[p] = \frac{P(1-P)}{n}
\end{equation}\]</div>
<p>which allow us to write a standard normal distribution from the z-score</p>
<div class="amsmath math notranslate nohighlight" id="equation-1f5b296e-4940-4211-abe4-174c0728db8a">
<span class="eqno">(1.86)<a class="headerlink" href="#equation-1f5b296e-4940-4211-abe4-174c0728db8a" title="Permalink to this equation">¶</a></span>\[\begin{equation}
Z = \frac{p-P}{\sqrt{\frac{P(1-P)}{n}}}
\end{equation}\]</div>
</div>
</div>
<div class="section" id="confidence-intervals">
<h2><span class="section-number">1.4. </span>Confidence Intervals<a class="headerlink" href="#confidence-intervals" title="Permalink to this headline">¶</a></h2>
<p>We know that the efficiency of an estimator is given in terms of its standard error, then we are going to incorporate this information to the point estimator. The result of this are going to be the *<em>confidence intervals</em>. In general (for symmetric distributions) we can say that</p>
<br>
<div class="amsmath math notranslate nohighlight" id="equation-28bd48f5-f38f-4dcf-bf24-d1682d686cf0">
<span class="eqno">(1.87)<a class="headerlink" href="#equation-28bd48f5-f38f-4dcf-bf24-d1682d686cf0" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\text{Confidence Interval} = \text{Point Estimator} \pm \text{Margin of Error}
\end{equation}\]</div>
<br>
<p>where the <strong>margin of error</strong> is the part that contains information about both, the probability distributioin of the population parameter and of the standard error of the estimator.</p>
<div class="section" id="confidence-interval-of-the-mean-of-a-population-with-known-variance">
<h3><span class="section-number">1.4.1. </span>Confidence Interval of the Mean of a Population with Known Variance<a class="headerlink" href="#confidence-interval-of-the-mean-of-a-population-with-known-variance" title="Permalink to this headline">¶</a></h3>
<p>We have already seen that making use of the sampling distribution of sample means, we can say three main ideas:</p>
<ul class="simple">
<li><p>that the <strong>point estimator</strong> of the population mean is the sample mean</p></li>
<li><p>that the <strong>standard error</strong> is given by the population variance divided by the sample size</p></li>
<li><p>that the distribution can be approximated by a <strong>normal distribution</strong></p></li>
</ul>
<p>With this in mind we can write the Z-score of this distribution as</p>
<br>
<div class="amsmath math notranslate nohighlight" id="equation-89bd8400-b768-4ab7-acdb-4bd5608accd6">
<span class="eqno">(1.88)<a class="headerlink" href="#equation-89bd8400-b768-4ab7-acdb-4bd5608accd6" title="Permalink to this equation">¶</a></span>\[\begin{equation}
Z = \frac{\bar x-E[\bar x]}{SD[\bar x]}=\frac{\bar x-\mu}{\sigma/\sqrt{n}}
\end{equation}\]</div>
</br>
<p>With this Z-score let’s find the probability</p>
<br>
<div class="amsmath math notranslate nohighlight" id="equation-3a221022-6b39-4148-9598-89887a977ee1">
<span class="eqno">(1.89)<a class="headerlink" href="#equation-3a221022-6b39-4148-9598-89887a977ee1" title="Permalink to this equation">¶</a></span>\[\begin{equation}
P(-z_{\alpha/2}&lt;Z&lt;z_{\alpha/2}) = 1-\alpha
\end{equation}\]</div>
</br>
<p>as seen in the graph below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">v2</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">mu</span>  <span class="o">=</span> <span class="mi">0</span>
<span class="n">s</span>   <span class="o">=</span> <span class="mi">1</span>
<span class="n">minX</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">-</span> <span class="mf">3.5</span><span class="o">*</span><span class="n">s</span>
<span class="n">maxX</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="mf">3.5</span><span class="o">*</span><span class="n">s</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minX</span><span class="p">,</span> <span class="n">maxX</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">px1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="n">v1</span><span class="p">]</span>
<span class="n">px2</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="n">v2</span><span class="p">]</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x3</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="n">ss</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">s</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;forestgreen&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">v2</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">ss</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">s</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">v1</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">ss</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">s</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$P(-z_{\alpha/2}&lt;Z\leq z_{\alpha/2}) = 1-\alpha$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([],</span> <span class="p">[])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$1-\alpha$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\frac{\alpha}</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\frac{\alpha}</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">2.2</span><span class="p">,</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$-z_{\alpha/2}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.9</span><span class="p">,</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$z_{\alpha/2}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07_Estimation_Theory_22_0.png" src="_images/07_Estimation_Theory_22_0.png" />
</div>
</div>
<p>see that <span class="math notranslate nohighlight">\(z_{\alpha/2}\)</span> represents the percentile such that its survival probability is <span class="math notranslate nohighlight">\(\alpha/2\)</span>, and <span class="math notranslate nohighlight">\(-z_{\alpha/2}\)</span> the percentile such that its cumulative probability is <span class="math notranslate nohighlight">\(\alpha/2\)</span>.</p>
<p>Using as Z the Z-score we just defined above it is easy to see that this probability can be written as</p>
<br>
<div class="amsmath math notranslate nohighlight" id="equation-55bd9b7c-c917-44f7-ae68-c577fe966b87">
<span class="eqno">(1.90)<a class="headerlink" href="#equation-55bd9b7c-c917-44f7-ae68-c577fe966b87" title="Permalink to this equation">¶</a></span>\[\begin{equation}
P\left(\bar x - z_{\alpha/2}\frac{\sigma}{\sqrt{n}} &lt; \mu \leq \bar x + z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\right)=1-\alpha
\end{equation}\]</div>
</br>
<p>It is from this equality from where we read the <strong>confidence interval</strong>, that can be written as</p>
<div class="amsmath math notranslate nohighlight" id="equation-9f5cdef7-bbcd-4a04-93f0-6a595be8667c">
<span class="eqno">(1.91)<a class="headerlink" href="#equation-9f5cdef7-bbcd-4a04-93f0-6a595be8667c" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mu\in\bar x \pm z_{\alpha/2}\frac{\sigma}{\sqrt{n}}
\end{equation}\]</div>
<p>for a <span class="math notranslate nohighlight">\((1-\alpha)\%\)</span> of confidence level.</p>
<div class="section" id="confidence-intervals-in-python">
<h4><span class="section-number">1.4.1.1. </span>Confidence Intervals in Python<a class="headerlink" href="#confidence-intervals-in-python" title="Permalink to this headline">¶</a></h4>
<p>The most straightforward way of finding the CI is to apply directly the formula, then suppose the following dataset for the sample of the <code class="docutils literal notranslate"><span class="pre">age</span></code> of a population</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">18</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mf">18.4</span><span class="p">,</span> <span class="mf">17.8</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mf">17.9</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mf">18.2</span><span class="p">,</span> <span class="mf">18.7</span><span class="p">,</span> <span class="mf">18.3</span><span class="p">,</span> <span class="mf">19.2</span><span class="p">,</span> <span class="mf">19.1</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s assume that we know:</p>
<ul class="simple">
<li><p>The population variance is 2</p></li>
<li><p>We want to find the 95% CI for the population mean</p></li>
</ul>
<p>Then</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_mean</span> <span class="o">=</span> <span class="n">age</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">pop_var</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
<span class="n">CL</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">SL</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">CL</span>
</pre></div>
</div>
</div>
</div>
<p>Now we find the <strong>margin of error</strong> as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ME</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">SL</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pop_var</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>and then the CI is given by</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lower</span> <span class="o">=</span> <span class="n">sample_mean</span> <span class="o">-</span> <span class="n">ME</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">sample_mean</span> <span class="o">+</span> <span class="n">ME</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">{:3.2%}</span><span class="s2"> Confidence Interval for the Population Mean is [</span><span class="si">{:4.3f}</span><span class="s2">, </span><span class="si">{:4.3f}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CL</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 95.00% Confidence Interval for the Population Mean is [18.309, 19.791]
</pre></div>
</div>
</div>
</div>
<p>We may also use <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> package but now be careful because in this case we have to take some steps before we obtain the result. Note that in this case we need to create <strong>always</strong> the object in statsmodels for the <code class="docutils literal notranslate"><span class="pre">DescrStatsW()</span></code> method, then</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">des</span> <span class="o">=</span> <span class="n">smw</span><span class="o">.</span><span class="n">DescrStatsW</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>this object contains the information we can call now using other functions of <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>, in this case the function<code class="docutils literal notranslate"><span class="pre">zconfint_mean</span></code> which returns the confidence interval for a normal population of known variance</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">low_ss</span><span class="p">,</span> <span class="n">upp_ss</span> <span class="o">=</span> <span class="n">des</span><span class="o">.</span><span class="n">zconfint_mean</span><span class="p">(</span><span class="n">SL</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">{:3.2%}</span><span class="s2"> Confidence Interval for the Population Mean using StatsModels is [</span><span class="si">{:4.3f}</span><span class="s2">, </span><span class="si">{:4.3f}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CL</span><span class="p">,</span> <span class="n">low_ss</span><span class="p">,</span> <span class="n">upp_ss</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 95.00% Confidence Interval for the Population Mean using StatsModels is [18.289, 19.811]
</pre></div>
</div>
</div>
</div>
<p>Why do they not coincide? Because statsmodels is not asking for a population variance! Be careful with this crucial point.</p>
</div>
<div class="section" id="changing-parameters">
<h4><span class="section-number">1.4.1.2. </span>Changing Parameters<a class="headerlink" href="#changing-parameters" title="Permalink to this headline">¶</a></h4>
<p>We can see that the width (error) of the CI we have just found depends on some parameters</p>
<ul class="simple">
<li><p>The percentile of the normal distribution</p></li>
<li><p>The sample size</p></li>
<li><p>The population variance</p></li>
</ul>
<p>The last one is something we simply cannot change, since it is a population value. However the other two can and should be chosen with care.</p>
<ul class="simple">
<li><p>If we simply increase the CL without any other change, we would simply enlarge the amount of possible values in the CI so if we choose 100% CI that means that we allow for all the values…we are definitely more confindent, but that does not give any useful information. Note that increasing the CL implies increasing the ME. In the context of hypothesis testing we will see how to choose the CL.</p></li>
<li><p>If we increase the sampe size we may reduce the error, since it is in the denominator, but be careful since the sample size must be decided <em>before</em> we make this computation.</p></li>
</ul>
</div>
</div>
<div class="section" id="interpretation-of-a-c-i">
<h3><span class="section-number">1.4.2. </span>Interpretation of a C.I.<a class="headerlink" href="#interpretation-of-a-c-i" title="Permalink to this headline">¶</a></h3>
<p>To understand the actual meaning of a confidence interval, let’s consider the following example:</p>
<ul class="simple">
<li><p>We have a <strong>population</strong> of 16 people of known age. In this case we can find the mean population age directly</p></li>
<li><p>We will take <strong>100 random samples</strong>, normally distributed, with mean the known population and standard deviation the known population standard deviation</p></li>
<li><p>We will compute the confidence intervals for these 100 samples and plot them comparing them with the population mean</p></li>
</ul>
<p>Our <strong>population</strong> is the following</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">18.5</span><span class="p">,</span> <span class="mf">17.6</span><span class="p">,</span> <span class="mf">21.1</span><span class="p">,</span> <span class="mf">17.1</span><span class="p">,</span> <span class="mf">49.0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">18.2</span><span class="p">,</span> <span class="mf">17.9</span><span class="p">,</span> <span class="mf">18.1</span><span class="p">,</span> <span class="mf">18.0</span><span class="p">,</span> <span class="mf">18.9</span><span class="p">,</span> <span class="mf">17.4</span><span class="p">,</span> <span class="mf">25.4</span><span class="p">,</span> <span class="mf">17.4</span><span class="p">,</span> <span class="mf">19.5</span><span class="p">,</span> <span class="mf">17.3</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>from where we can find the values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">age</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">sd</span> <span class="o">=</span> <span class="n">age</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The population has </span><span class="se">\n\n</span><span class="s2">MEAN: </span><span class="si">{:&lt;6.3f}</span><span class="se">\n</span><span class="s2">STANDARD DEVIATION: </span><span class="si">{:&lt;6.3f}</span><span class="se">\n</span><span class="s2">SIZE: </span><span class="si">{:&lt;6.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">sd</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The population has 

MEAN: 21.025
STANDARD DEVIATION: 7.638 
SIZE: 16    
</pre></div>
</div>
</div>
</div>
<p>Now we can define the function that will compute the confidence intervals. We do it with a default <strong>significance level</strong> of 0.05 which is equivalent to a confidence interval of 95%</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">c_int</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">):</span>
  <span class="n">des</span> <span class="o">=</span> <span class="n">smw</span><span class="o">.</span><span class="n">DescrStatsW</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">des</span><span class="o">.</span><span class="n">zconfint_mean</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)),</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="s1">&#39;upper&#39;</span><span class="p">])</span>
  <span class="k">return</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally we gerate a dataframe with the <strong>100 random samples</strong> taken from a normal population of known mean and variance (the ones found before)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nran</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">sd</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nran</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span>
<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14.077299</td>
      <td>6.473092</td>
      <td>23.953185</td>
      <td>16.870187</td>
      <td>29.268928</td>
      <td>14.089693</td>
      <td>12.454461</td>
      <td>27.540222</td>
    </tr>
    <tr>
      <th>1</th>
      <td>19.642931</td>
      <td>17.930934</td>
      <td>28.153068</td>
      <td>35.562665</td>
      <td>21.727270</td>
      <td>18.882847</td>
      <td>13.530529</td>
      <td>12.809864</td>
    </tr>
    <tr>
      <th>2</th>
      <td>32.328874</td>
      <td>22.423784</td>
      <td>25.451831</td>
      <td>9.541446</td>
      <td>21.799230</td>
      <td>27.823055</td>
      <td>8.688776</td>
      <td>7.720500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20.494215</td>
      <td>29.899173</td>
      <td>27.445185</td>
      <td>24.641368</td>
      <td>28.775611</td>
      <td>25.375303</td>
      <td>28.709359</td>
      <td>27.652346</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17.160466</td>
      <td>19.875723</td>
      <td>20.467998</td>
      <td>36.542461</td>
      <td>31.871691</td>
      <td>30.376511</td>
      <td>21.078803</td>
      <td>13.235413</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The next chunk returns a dataframe with <strong>100 confidence intervals</strong> for the previous samples: one per column</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cint_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="s1">&#39;upper&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
  <span class="n">cint_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_int</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">cint_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>lower</th>
      <td>19.113585</td>
      <td>13.910892</td>
      <td>21.987772</td>
      <td>15.511207</td>
      <td>18.603887</td>
      <td>17.129098</td>
      <td>15.495714</td>
      <td>19.659067</td>
    </tr>
    <tr>
      <th>upper</th>
      <td>25.701668</td>
      <td>21.225325</td>
      <td>28.472619</td>
      <td>25.254727</td>
      <td>24.992587</td>
      <td>23.724012</td>
      <td>21.048493</td>
      <td>28.620901</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now we can plot all the confidence intervals, see that we are going to plot them as lines covering the whole range then inthe plot we have:</p>
<ul class="simple">
<li><p>In the horizontal axis, the range covered by the confidence intervals</p></li>
<li><p>In the vertical axis, the index of the confindence interval, spaced in intervals of 0.5</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">cint_df</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">cint_df</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Confidence Intervals&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyles</span> <span class="o">=</span> <span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;TRUE MEAN&quot;</span><span class="p">,</span> <span class="n">xytext</span> <span class="o">=</span> <span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> 
             <span class="n">ha</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> 
             <span class="n">va</span> <span class="o">=</span> <span class="s2">&quot;top&quot;</span><span class="p">,</span>
             <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
             <span class="n">arrowprops</span><span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span> <span class="o">=</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> 
                              <span class="n">connectionstyle</span> <span class="o">=</span> <span class="s2">&quot;angle&quot;</span><span class="p">,</span> 
                              <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
                              <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07_Estimation_Theory_49_0.png" src="_images/07_Estimation_Theory_49_0.png" />
</div>
</div>
<p>If we want to find how many of the confidence intervals do actually contain the population mean we can just do (note that this value should be 95 or close to it once we have taken that as our confidence level)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">cint_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cint_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">m</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>87
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="confidence-interval-for-the-population-mean-of-a-population-with-unkown-variance">
<h3><span class="section-number">1.4.3. </span>Confidence Interval for the Population Mean of a Population with Unkown Variance<a class="headerlink" href="#confidence-interval-for-the-population-mean-of-a-population-with-unkown-variance" title="Permalink to this headline">¶</a></h3>
<p>The case we are going to study now can also be understood in the context of <strong>Small Samples</strong>, since now the Central Limit Theorem cannot be applied and we are not allowed to use the normal approximation.</p>
<p>In this case we introduce a new probability distribution: the <strong>t-Student</strong> distribution.</p>
<div class="section" id="the-t-student-distribution">
<h4><span class="section-number">1.4.3.1. </span>The t-Student distribution<a class="headerlink" href="#the-t-student-distribution" title="Permalink to this headline">¶</a></h4>
<p>To define thsi distribution we use the <span class="math notranslate nohighlight">\(\chi^2\)</span> distribution since it provides and estimation of the population variance, then we write it as</p>
<div class="amsmath math notranslate nohighlight" id="equation-e29fc87e-923c-4082-b01e-52f649aa0450">
<span class="eqno">(1.92)<a class="headerlink" href="#equation-e29fc87e-923c-4082-b01e-52f649aa0450" title="Permalink to this equation">¶</a></span>\[\begin{equation}
t = \frac{Z}{\sqrt{\frac{\chi^2}{n}}} = \frac{\bar x-\mu}{s/\sqrt{n}}
\end{equation}\]</div>
<p>then see that it is basically a z-score in which we replace the population variance by the sample variance. Let’s make a graphical representation of this distribution. For it we import it from the <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> package</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<p>now, the only point in this case is that, as with the <span class="math notranslate nohighlight">\(\chi^2\)</span> distribution, we have to use the <strong>degrees of freedom</strong> as depending on the sample size</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">nSet</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;t Distribution&quot;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nSet</span><span class="p">:</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;DoF: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Normal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07_Estimation_Theory_56_0.png" src="_images/07_Estimation_Theory_56_0.png" />
</div>
</div>
<p>Note that:</p>
<ul class="simple">
<li><p>The t-distribution has heavier tails than a normal distribution and, consequently, is less peaked.</p></li>
<li><p>It tends to the normal distribution as we increase <span class="math notranslate nohighlight">\(n\)</span>. In the graph we see that for a sample size of 50 we have more or less the same distribution. This is the minimum sample size we will use to allow for a normal approximation.</p></li>
</ul>
<p>With this distribution and following the same steps as before we can write the <strong>Confidence Interval</strong> as</p>
<div class="amsmath math notranslate nohighlight" id="equation-9a2aaf24-b7ad-4dea-9232-be2581adb2b1">
<span class="eqno">(1.93)<a class="headerlink" href="#equation-9a2aaf24-b7ad-4dea-9232-be2581adb2b1" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mu\in\bar x \pm t_{n-1,\alpha/2}\frac{s}{\sqrt{n}}
\end{equation}\]</div>
<p>for a <span class="math notranslate nohighlight">\((1-\alpha)\%\)</span> of confidence level</p>
</div>
<div class="section" id="confidence-interval-in-python">
<h4><span class="section-number">1.4.3.2. </span>Confidence Interval in Python<a class="headerlink" href="#confidence-interval-in-python" title="Permalink to this headline">¶</a></h4>
<p>Let’s now find the confidence interval for the same case as before without assuming that we are given a population variance, then</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">18</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mf">18.4</span><span class="p">,</span> <span class="mf">17.8</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mf">17.9</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mf">18.2</span><span class="p">,</span> <span class="mf">18.7</span><span class="p">,</span> <span class="mf">18.3</span><span class="p">,</span> <span class="mf">19.2</span><span class="p">,</span> <span class="mf">19.1</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">])</span>

<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">age</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">sample_var</span> <span class="o">=</span> <span class="n">age</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
<span class="n">CL</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">SL</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">CL</span>
</pre></div>
</div>
</div>
</div>
<p>Then we use directly the formula given above as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ME_t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">SL</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sample_var</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>

<span class="n">lower_t</span> <span class="o">=</span> <span class="n">sample_mean</span> <span class="o">-</span> <span class="n">ME_t</span>
<span class="n">upper_t</span> <span class="o">=</span> <span class="n">sample_mean</span> <span class="o">+</span> <span class="n">ME_t</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">{:3.2%}</span><span class="s2"> Confidence Interval for the Population Mean is [</span><span class="si">{:4.3f}</span><span class="s2">, </span><span class="si">{:4.3f}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CL</span><span class="p">,</span> <span class="n">lower_t</span><span class="p">,</span> <span class="n">upper_t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 95.00% Confidence Interval for the Population Mean is [18.241, 19.859]
</pre></div>
</div>
</div>
</div>
<p>To find this CI using <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> we do</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">des</span> <span class="o">=</span> <span class="n">smw</span><span class="o">.</span><span class="n">DescrStatsW</span><span class="p">(</span><span class="n">age</span><span class="p">)</span>

<span class="n">low_t</span><span class="p">,</span> <span class="n">upp_t</span> <span class="o">=</span> <span class="n">des</span><span class="o">.</span><span class="n">tconfint_mean</span><span class="p">(</span><span class="n">SL</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">{:3.2%}</span><span class="s2"> StatsModels Confidence Interval for the Population Mean is [</span><span class="si">{:4.3f}</span><span class="s2">, </span><span class="si">{:4.3f}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CL</span><span class="p">,</span> <span class="n">low_t</span><span class="p">,</span> <span class="n">upp_t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 95.00% StatsModels Confidence Interval for the Population Mean is [18.211, 19.889]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="confidence-interval-for-a-population-proportion">
<h3><span class="section-number">1.4.4. </span>Confidence Interval for a Population Proportion<a class="headerlink" href="#confidence-interval-for-a-population-proportion" title="Permalink to this headline">¶</a></h3>
<p>In case we can use the normal approximation, i.e. if</p>
<div class="amsmath math notranslate nohighlight" id="equation-939e3363-9282-499e-bff7-732f3416923c">
<span class="eqno">(1.94)<a class="headerlink" href="#equation-939e3363-9282-499e-bff7-732f3416923c" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\begin{array}{rcl}
np &amp; &gt; &amp; 10\\[2ex]
nq &amp; &gt; &amp; 10
\end{array}
\end{equation}\]</div>
<p>we can use the results we found before to write</p>
<div class="amsmath math notranslate nohighlight" id="equation-714d2b66-9e86-4e64-9907-08b7ac779631">
<span class="eqno">(1.95)<a class="headerlink" href="#equation-714d2b66-9e86-4e64-9907-08b7ac779631" title="Permalink to this equation">¶</a></span>\[\begin{equation}
P\in p\pm z_{\alpha/2}\sqrt{\frac{p(1-p)}{n}}
\end{equation}\]</div>
<p>for a <span class="math notranslate nohighlight">\((1-\alpha)\%\)</span> of CL.</p>
<div class="section" id="id1">
<h4><span class="section-number">1.4.4.1. </span>Confidence Interval in Python<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Just in the previous cases we can use either the formula or the <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> package. To see it, let’s generate a random dataset as follows</p>
<ul class="simple">
<li><p>In the data set <code class="docutils literal notranslate"><span class="pre">1</span></code> will correspond to a <code class="docutils literal notranslate"><span class="pre">yes</span></code> in a questioinnaire and <code class="docutils literal notranslate"><span class="pre">0</span></code> will correspond to a <code class="docutils literal notranslate"><span class="pre">no</span></code></p></li>
<li><p>We will find the sample proportion and then the confidence interval</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">400</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>let’s check if we can use the normal approximation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">n</span>

<span class="n">NP</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="n">p</span>
<span class="n">NQ</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span>

<span class="k">if</span> <span class="n">NP</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">NQ</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We CAN use the Normal Approximation since np = </span><span class="si">{:&lt;3.0f}</span><span class="s2"> and nq = </span><span class="si">{:&lt;3.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">NP</span><span class="p">,</span><span class="n">NQ</span><span class="p">))</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We CANNOT use the Normal Approximation since np = </span><span class="si">{:&lt;3.0f}</span><span class="s2"> and nq = </span><span class="si">{:&lt;3.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">NP</span><span class="p">,</span><span class="n">NQ</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>We CAN use the Normal Approximation since np = 207 and nq = 193
</pre></div>
</div>
</div>
</div>
<p>Now we just find the <strong>margin of error</strong> and the <strong>confidence interval</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ME</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">SL</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>

<span class="n">lower_p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="n">ME</span>
<span class="n">upper_p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">ME</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">{:3.2%}</span><span class="s2"> Confidence Interval for the Population Proportion is [</span><span class="si">{:4.3f}</span><span class="s2">, </span><span class="si">{:4.3f}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CL</span><span class="p">,</span> <span class="n">lower_p</span><span class="p">,</span> <span class="n">upper_p</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 95.00% Confidence Interval for the Population Proportion is [0.469, 0.566]
</pre></div>
</div>
</div>
</div>
<p>If we want to use the <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> package we use the <code class="docutils literal notranslate"><span class="pre">proportion</span></code> module</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">low_sp</span><span class="p">,</span> <span class="n">upp_sp</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">proportion_confint</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">SL</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">{:3.2%}</span><span class="s2"> Statsmodels Confidence Interval for the Population Proportion is [</span><span class="si">{:4.3f}</span><span class="s2">, </span><span class="si">{:4.3f}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CL</span><span class="p">,</span> <span class="n">low_sp</span><span class="p">,</span> <span class="n">upp_sp</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 95.00% Statsmodels Confidence Interval for the Population Proportion is [0.469, 0.566]
</pre></div>
</div>
</div>
</div>
<p>which, in this case, coincide with our previous result</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="06_Probability_Distribution_Functions.html" title="previous page"><span class="section-number">1. </span>Probability Distribution Functions</a>
    <a class='right-next' id="next-link" href="08_Confidence_Intervals.html" title="next page"><span class="section-number">2. </span><font color = "Red">Cases and Conditions</font></a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Prof. Juanjo Manjarín<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>